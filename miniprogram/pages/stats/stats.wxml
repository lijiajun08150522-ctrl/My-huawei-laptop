<!--pages/stats/stats.wxml-->
<view class="container">
  <view class="header">
    <text class="header-title">今日简报</text>
    <text class="header-date">{{todayDate}}</text>
  </view>

  <view class="stats-card main-card">
    <view class="completion-rate-large">
      <text class="rate-number">{{stats.completionRate}}</text>
      <text class="rate-symbol">%</text>
      <text class="rate-label">完成率</text>
    </view>
  </view>

  <view class="stats-grid">
    <view class="stat-card">
      <text class="stat-number total">{{stats.total}}</text>
      <text class="stat-label">总任务</text>
    </view>
    <view class="stat-card">
      <text class="stat-number completed">{{stats.completed}}</text>
      <text class="stat-label">已完成</text>
    </view>
    <view class="stat-card">
      <text class="stat-number pending">{{stats.pending}}</text>
      <text class="stat-label">待办</text>
    </view>
  </view>

  <view class="section">
    <text class="section-title">分类统计</text>
    <view class="category-stats">
      <view
        wx:for="{{categoryStats}}"
        wx:key="category"
        class="category-item"
      >
        <text class="category-name">{{item.category}}</text>
        <view class="category-bar">
          <view
            class="bar-fill"
            style="width: {{item.percentage}}%; background: {{item.color}}"
          ></view>
        </view>
        <text class="category-count">{{item.count}}</text>
      </view>
    </view>
  </view>

  <view class="section">
    <text class="section-title">优先级分布</text>
    <view class="priority-stats">
      <view
        wx:for="{{priorityStats}}"
        wx:key="priority"
        class="priority-item"
      >
        <view class="priority-dot" style="background: {{item.color}}"></view>
        <text class="priority-name">{{item.priority}}</text>
        <text class="priority-count">{{item.count}}</text>
      </view>
    </view>
  </view>

  <view class="section" wx:if="{{warning}}">
    <view class="warning-section">
      <text class="warning-icon">⚠️</text>
      <text class="warning-text">任务积压过多（{{stats.pending}}个待办），请优先处理！</text>
    </view>
  </view>
</view>
